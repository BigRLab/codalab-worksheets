{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}Competition - [{{ competition.title }}]{% endblock %}
{% block extra_head %}
<script src="{% static "site/js/FileUpload.js" %}"></script>
<script src="{% static "site/js/CompetitionDetailsTs.js" %}"></script>
{% endblock %}
{% block content %}
<div class="row">
    <div class="large-12 large-centered columns">
        <div class="CompetitionsDetailContainer">
            <section class="competitionsDetailHeader">
                <figure class="competitionsProfileImage">
                    {% if competition.image_url %}
                    <img id="imgProfileImage" src="{{ competition.image_url }}" width="133px">
                    {% else %}
                    <img id="imgProfileImage" src="{% static "site/Images/ProfileImageDummy.jpg" %}" width="133px" height="94">
                    {% endif %}
                </figure>
                <div class="competitionsHeaderTitle">
                        <h2>{{ competition.title }}</h2>
                        <label id="lblLastModifiedDate"> by {{ competition.creator }} - Last Modified: {{ competition.last_modified }} </label>                    
                        <input id="submissionId" name="submissionId"  type="hidden" />
                        <input id="activePhase" name="activePhase"  type="hidden" />
                        <input id="selctedPhaseButton" name="selctedPhaseButton"  type="hidden" />
                        <input id="selectedRank" name="selectedRank"  type="hidden"  value="1"/>
                    <div class="StatusStripContainer">
                        <div class="challStatusStripTxt">
                            <div class="dataStatusHolder">
                                <span></span>
                            </div>
                        </div>
                        <div class="challStatusStrip">
                            <div class="challStatusStripLevel">
                            </div>
                            <section class="challStatusStripSection">
                                {% for phase in competition.phases.all %}
                                <section>
                                    <label>
                                        <span>{{phase.label}}</span> 
                                        <br>
                                        <span>{{phase.start_date}}</span>
                                    </label>
                                </section>
                                {% endfor %}
                                <section>
                                    <label>
                                        <span>Competition Ends</span> 
                                        <br>
                                        <span>{{competition.end_date|default:"Never"}}</span>
                                    </label>
                                </section>
                            </section>
                        </div>
                    </div>
                </div>
            </section>
            <div class="section-container auto competitionsDetailTabArea" data-section data-section-resized data-options="deep_linking:true">
                {% for tab, contents in tabs.items %}
                <section>
                    <p class="title" id="{{tab.name}}" data-section-title>
                        <a href="#{{tab.codname}}">{{tab.name}}</a>
                    </p>
                    <div class="content" data-slug="{{tab.codename}}" data-section-content>
                        {% if tab.codename == "participate" and not user.is_authenticated %}
                            <strong>You must be logged in to participate in competitions.</strong>
                            <br/>
                            <div class="globalBlueButtonAtag">
                                <a href="{% url 'account_login' %}">Sign in</a>
                            </div>
                        {% else %}
                            {% if tab.codename == "participate" and not participant %}
                                <strong>You have not yet registered for this competition.</strong>
                                <br/>
                                <p>To participate in this competition, you must accept its specific terms and conditions. After you register, the competition organizer will review your application and notify you when your participation is approved.</p>
                                <br/>
                                I accept the <a href="#learn_the_details-3">terms and conditions</a> of the competition.
                                <div class="globalBlueButtonAtag">
                                    <a href="/api/competition/{{competition.id}}/participate/">Register</a>
                                </div>         
                            {% endif %}
                        {% endif %}
                        {% include "web/competitions/_participate.html" with tab=tab contents=contents %}
                    </div>
                </section>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block js %}
$('document').ready(function() {
// This helps make sections appear with Foundation
$(this).foundation('section', 'reflow');
});
{% endblock js %}